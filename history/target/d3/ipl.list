     1                                  ORG   0x7c00          ; 引导区加载位置
     2                                                        ; 与之相对的详细内存分区可参考 http://www.bioscentral.com/misc/bda.htm
     3                                  
     4                                  ;--------------------------------------- FAT12 格式描述 ------------------------------------------
     5                                  ; FAT12 引导扇区格式参见 http://blog.sina.com.cn/s/blog_3edcf6b80100cr08.html
     6 00000000 EB4E                    JMP   entry
     7 00000002 90                      DB    0x90
     8 00000003 414E4F5349504C20        DB    "ANOSIPL "      ; OEM字符串，8字节（通常为格式化本磁盘的操作系统名称及版本）
     9 0000000B 0002                    DW    512             ; 每个扇区(sector)大小，必须为512(B)
    10 0000000D 01                      DB    1               ; 簇(cluster)的大小，必须为1（个扇区）
    11 0000000E 0100                    DW    1               ; FAT的起始扇区数（一般从第一个扇区开始）
    12 00000010 02                      DB    2               ; FAT的个数（必须为2）
    13 00000011 E000                    DW    224             ; 根目录的大小（一般设成224项）
    14 00000013 400B                    DW    2880            ; 该磁盘的大小（必须设成2880扇区，即1440KB）
    15 00000015 F0                      DB    0xf0            ; 磁盘的种类（必须为F0）
    16 00000016 0900                    DW    9               ; FAT的长度（必须是9扇区）
    17 00000018 1200                    DW    18              ; 每个磁道的扇区数（必须是18）
    18 0000001A 0200                    DW    2               ; 磁头数（必须是2）
    19 0000001C 00000000                DD    0               ; 不使用分区（必须是0）
    20 00000020 400B0000                DD    2880            ; 重写一次磁盘大小
    21 00000024 000029                  DB    0,0,0x29        ; 意义不名
    22 00000027 FFFFFFFF                DD    0xffffffff      ; （可能是）卷标号码
    23 0000002B 574841545448454655-     DB    "WHATTHEFUCK"   ; 磁盘的名称（11字节）
    24 00000034 434B               
    25 00000036 4641543132202020        DB    "FAT12   "      ; 磁盘格式名称（8字节）
    26 0000003E <res 00000012>          RESB  18              ; 先空出18字节
    27          ******************       warning: uninitialized space declared in .text section: zeroing
    28                                  
    29                                  
    30                                  ;------------------------------------------ 程序主体 ---------------------------------------------
    31                                  ; BIOS中断表参见 http://www.cnblogs.com/walfud/articles/2980774.html
    32                                  entry:
    33 00000050 B80000                    mov AX, 0
    34 00000053 8ED0                      mov SS, AX
    35 00000055 BC007C                    mov SP, 0x7c00
    36 00000058 8ED8                      mov DS, AX
    37                                  
    38 0000005A B82008                    mov AX, 0x0820
    39 0000005D 8EC0                      mov ES, AX                  ; ES无法被赋值为立即数, 参见
    40                                                                ; http://blog.sina.com.cn/s/blog_9407914801017rw3.html
    41 0000005F BB0000                    mov BX, 0                   ; ES:BX 表示数据缓冲区地址
    42 00000062 B500                      mov CH, 0                   ; 柱面 0
    43 00000064 B600                      mov DH, 0                   ; 磁头 0
    44 00000066 B102                      mov CL, 2                   ; 扇区 2
    45 00000068 B001                      mov AL, 1                   ; 读入扇区数
    46 0000006A BB0000                    mov BX, 0
    47 0000006D B200                      mov DL, 0x00                ; A驱动器
    48 0000006F B402                      mov AH, 0x02                ; 中断参数：读操作
    49 00000071 CD13                      int 0x13                    ; 0x13 ：磁盘读写中断
    50 00000073 720F                      jc error
    51 00000075 EB03                      jmp success
    52                                  
    53                                  fin:
    54 00000077 F4                        hlt
    55 00000078 EBFD                      jmp fin                     ; 死循环
    56                                  
    57                                  success:                      ; 成功读取
    58 0000007A B8[BA00]                  mov AX, succmsg
    59 0000007D 89C5                      mov BP, AX
    60 0000007F B91100                    mov CX, succmsglen
    61 00000082 EB08                      jmp display
    62                                  error:                        ; 出现错误
    63 00000084 B8[A000]                  mov AX, errmsg
    64 00000087 89C5                      mov BP, AX
    65 00000089 B91A00                    mov CX, errmsglen
    66                                  
    67                                  ; ---------------------------- 显示信息：公用代码 ------------------------------------------------
    68                                  
    69                                  display:
    70 0000008C B80000                    mov AX, 0                   ; 不可以使用0x7c00, 由于本程序使用了 org 0x7c00指令，因此 succmsg
    71                                                                ; 或者errmsg已经从文件中的相对位置向后偏移了0x7c00
    72 0000008F 8EC0                      mov ES, AX                  ; 将会显示从ES:BP开始的字符串
    73 00000091 B001                      mov AL, 0x01                ; 目标位置包含字符，且属性在BL中包含，参见
    74                                                                ; http://blog.csdn.net/pdcxs007/article/details/43378229
    75 00000093 B700                      mov BH, 0                   ; 视频区页数
    76 00000095 BA0000                    mov DX, 0                   ; DH = 行数, DL = 列数，此处显示位置为 0,0
    77 00000098 B3FC                      mov BL, 0xFC
    78 0000009A B413                      mov AH, 0x13                ; 显示中断参数：显示字符串
    79 0000009C CD10                      int 0x10                    ; 调用显示中断
    80 0000009E EBD7                      jmp fin
    81                                  
    82                                  errmsg:
    83 000000A0 6572726F7220666F75-       db "error found while reading"
    84 000000A9 6E64207768696C6520-
    85 000000B2 72656164696E67     
    86 000000B9 0A                        db 0x0a
    87                                  errmsglen equ $ - errmsg
    88                                  succmsg:
    89 000000BA 66696E697368656420-       db "finished reading"
    90 000000C3 72656164696E67     
    91 000000CA 0A                        db 0x0a
    92                                  succmsglen equ $ - succmsg
    93                                  
    94 000000CB 00<rept>                TIMES (0x01FE-($-$$)) db 0    ; 填充当前扇区。不知道为何原文给定的填充结束位置为0x7dfe
    95                                                                ; 不过这个填充位置显然是错的，因为这样55AA标志便远在引导扇区之外
    96                                                                ; 因此我们将填充位置改为 0x01FE，因为 0x01FE + 2 = 0x0200恰好为
    97                                                                ; 第一个扇区的长度
    98 000001FE 55AA                    DB    0x55, 0xaa
